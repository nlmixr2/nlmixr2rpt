<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nlmixr2rpt">
<title>Reporting nlmixr2 Fit Results • nlmixr2rpt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reporting nlmixr2 Fit Results">
<meta property="og:description" content="nlmixr2rpt">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlmixr2rpt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--tutorials">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Tutorials
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--tutorials">
    <a class="dropdown-item" href="../articles/Reporting_nlmixr_Fit_Results.html">Reporting nlmixr Fit Results</a>
    <a class="dropdown-item" href="../articles/Accessing_Figures_and_Tables.html">Accessing Figures and Tables</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fas fa fas fa-hat-wizard"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fas fa fas fa-rss"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2rpt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="Reporting_nlmixr_Fit_Results_files/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="Reporting_nlmixr_Fit_Results_files/tabwid-1.0.0/scrool.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Reporting nlmixr2 Fit Results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2rpt/blob/HEAD/vignettes/Reporting_nlmixr_Fit_Results.Rmd" class="external-link"><code>vignettes/Reporting_nlmixr_Fit_Results.Rmd</code></a></small>
      <div class="d-none name"><code>Reporting_nlmixr_Fit_Results.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction
<img src="nlmixr2rpt_hex.png" align="right" width="138.5" border="0px"><a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of <code>nlmixr2rpt</code> is to automate reporting of
<code>nlmixr2</code> analyses. This is accomplished by creating a yaml
file that contains reporting options, figure and table generation code,
and general content for Word and PowerPoint files.</p>
</div>
<div class="section level2">
<h2 id="general-workflow">General workflow<a class="anchor" aria-label="anchor" href="#general-workflow"></a>
</h2>
<p>First we need an <code>nlmixr2</code> fit object. We’re going to load
a fit example stored in this package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2rpt.nlmixr2.com" class="external-link">nlmixr2rpt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://onbrand.ubiquity.tools/" class="external-link">onbrand</a></span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># This will create an example fit object to use in the examples below</span></span>
<span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/fetch_fit_example.html">fetch_fit_example</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next we need to create <code>onbrand</code> report objects. This will
create report objects for both PowerPoint (<code>obnd_pptx</code>) and
Word (<code>obnd_docx</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd_pptx</span> <span class="op">=</span> <span class="fu"><a href="https://onbrand.ubiquity.tools/reference/read_template.html" class="external-link">read_template</a></span><span class="op">(</span></span>
<span>  template <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"nlmixr2rpt"</span>, <span class="st">"templates"</span>,<span class="st">"nlmixr_obnd_template.pptx"</span><span class="op">)</span>,</span>
<span>  mapping  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"nlmixr2rpt"</span>, <span class="st">"templates"</span>,<span class="st">"nlmixr_obnd_template.yaml"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obnd_docx</span> <span class="op">=</span> <span class="fu"><a href="https://onbrand.ubiquity.tools/reference/read_template.html" class="external-link">read_template</a></span><span class="op">(</span></span>
<span>  template <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"nlmixr2rpt"</span>, <span class="st">"templates"</span>,<span class="st">"nlmixr_obnd_template.docx"</span><span class="op">)</span>,</span>
<span>  mapping  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"nlmixr2rpt"</span>, <span class="st">"templates"</span>,<span class="st">"nlmixr_obnd_template.yaml"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next we will add the report elements to the report objects using the
<code><a href="../reference/report_fit.html">report_fit()</a></code> function. This function can be used with both
types of report. The contents will be different depending on the
document type.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">obnd_pptx</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_fit.html">report_fit</a></span><span class="op">(</span></span>
<span>  fit     <span class="op">=</span> <span class="va">fit</span>, </span>
<span>  obnd    <span class="op">=</span> <span class="va">obnd_pptx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obnd_docx</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_fit.html">report_fit</a></span><span class="op">(</span></span>
<span>  fit     <span class="op">=</span> <span class="va">fit</span>, </span>
<span>  obnd    <span class="op">=</span> <span class="va">obnd_docx</span><span class="op">)</span></span></code></pre></div>
<p>This function will append the report elements for the supplied fit
object to the supplied report. If you have multiple fit objects they can
added sequentially. You can also add other report content using the
<code>onbrand</code> and <code>officer</code> functions. Once you’re
done then you just need to save the reports:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://onbrand.ubiquity.tools/reference/save_report.html" class="external-link">save_report</a></span><span class="op">(</span><span class="va">obnd_pptx</span>, <span class="st">"report.pptx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://onbrand.ubiquity.tools/reference/save_report.html" class="external-link">save_report</a></span><span class="op">(</span><span class="va">obnd_docx</span>, <span class="st">"report.docx"</span><span class="op">)</span></span></code></pre></div>
<p>The contents of each report type is defined in a yaml file. The
commands above use the default value found in the
<code>nlmixr2rpt</code> package. To customize the report elements you
can make a copy of the file in your current working directory:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"nlmixr2rpt"</span>, <span class="st">"templates"</span>, <span class="st">"report_fit.yaml"</span><span class="op">)</span>, </span>
<span>          <span class="st">"my_report.yaml"</span><span class="op">)</span></span></code></pre></div>
<p>Then you can edit the <code>my_report.yaml</code> file and when you
call <code><a href="../reference/report_fit.html">report_fit()</a></code> provide this yaml file as the
<code>rptyaml</code> argument. The following section will describe the
elements of the yaml report format.</p>
</div>
<div class="section level2">
<h2 id="the-yaml-report-file-structure">The yaml report file structure<a class="anchor" aria-label="anchor" href="#the-yaml-report-file-structure"></a>
</h2>
<p>The core of <code>nlmixr2rpt</code> is the yaml reporting file. Below
we outline each of the main sections and describe the expected elements
in those sections.</p>
<div class="section level3">
<h3 id="placeholders">
<code>placeholders</code><a class="anchor" aria-label="anchor" href="#placeholders"></a>
</h3>
<p>You may wish create your report template with placeholders. For
example if you want create a generic template for population PK
analysis, it may be useful to label the figures generically. You can use
this section to define placeholders that will be applied when the report
is created. For example consider the yaml code here:</p>
<pre><code>placeholders:
  CMPD: Compound Name
  CUNITS: Conc Units
  OBJ: sprintf("%3g", fit$objf)</code></pre>
<p>When you create the report you can label your y-axis generically such
as:</p>
<p><code>"===CMPD=== (===CUNITS===)"</code></p>
<p>But when the report is built, it will become:</p>
<p><code>"Compound Name (Conc Units)"</code></p>
<p>Notice that the <code>OBJ</code> placeholder contains R Code. By
default the reporting process will try to evaluate the placeholders as R
Code. If that fails it will revert back to the string supplied. If you
run into problems you can quote your placeholder value with both double
and single quotes. For example:</p>
<pre><code><span>  <span class="va">ISSTR</span><span class="op">:</span><span class="st">"'ls()'"</span></span>
<span>  <span class="va">ISCMD</span><span class="op">:</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>The <code>ISSTR</code> field will just result in the string
<code>"ls()"</code> while the <code>ISCMD</code> field will return a
list of the objects in the environment where the string is evaluated. It
is also possible to overwrite the contents of this file at runtime by
providing a <code>placeholders</code> (placeholder) argument to
<code><a href="../reference/report_fit.html">report_fit()</a></code>.</p>
<p><strong>Note:</strong> Fields that support placeholders will be
indicated by <sup>[PH]</sup> and fields with evaluable code will be
indicated by <sup>[EV]</sup>.</p>
</div>
<div class="section level3">
<h3 id="parameters">
<code>parameters</code><a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>For certain reporting elements it may be better to present parameters
differently than the parameter names being used in the model. In
<code>nlmixr</code> you can use a comment after the parameter definition
to specify alternate text. The function <code><a href="../reference/gen_pest_table.html">gen_pest_table()</a></code>
will use this alternate text if it is present. In the
<code>parameters</code> section you have some more flexability in how
parameters are reported. You can define any parameters you want here
whether they are present in the model or not. They will only be used if
they are present. For tables in Word or PowerPoint you can specify the
names using markdown (<code>md</code>), otherwise you can specify how
they will be handled in text environments (<code>txt</code>). For
example the intrinsic clearance may be called <code>lCLint</code> in the
model. And you can specify it as:</p>
<pre><code><span><span class="va">parameters</span><span class="op">:</span></span>
<span>  <span class="va">lCLint</span><span class="op">:</span>    </span>
<span>    <span class="va">md</span><span class="op">:</span>  <span class="st">"CL~int~ (L/hr)"</span>    </span>
<span>    <span class="va">txt</span><span class="op">:</span> <span class="st">"CLint (L/hr)"</span>    </span></code></pre>
<p>It is also possible to overwrite the contents of this file at runtime
by providing a <code>parameters</code> argument to
<code><a href="../reference/report_fit.html">report_fit()</a></code>.</p>
<p><strong>Note:</strong> If you specify a parameter name here it will
overwrite any alternate text specified in the model
<code>ini()</code>.</p>
</div>
<div class="section level3">
<h3 id="covariates">
<code>covariates</code><a class="anchor" aria-label="anchor" href="#covariates"></a>
</h3>
<p>For figure and table generation it can be useful to have your
covariates defined. You can define them here as either categorical
(<code>cat</code>) or continuous (<code>cont</code>). For example to
define the categorical covariates as SEX and ROUTE and the continuous
covariate as WT you would do the following:</p>
<pre><code>covariates:
  cat: ["SEX", "ROUTE"]
  cont: ["WT"]</code></pre>
<p>If you don’t need any covariates you can set them to
<code>NULL</code>. If you want to overwrite these at runtime you can
specify different values when calling <code><a href="../reference/report_fit.html">report_fit()</a></code>. These
are available in the figure and table runtime environments as the
objects <code>cat_covars</code> for categorical covariates and
<code>cont_covars</code> for continuous covariates.</p>
</div>
<div class="section level3">
<h3 id="options">
<code>options</code><a class="anchor" aria-label="anchor" href="#options"></a>
</h3>
<p>This section allows you to control general report options. Each
element here can be either an explicit value. If identified as evaluable
<sup>[EV]</sup> it will first attempt to evaluate it as R code. If that
fails the explicit value will be used. The following options are
supported with the expected data type in parentheses:</p>
<ul>
<li><p><code>output_dir</code><sup>[PH,EV]</sup> - The location where
figures will be generated (character)</p></li>
<li><p><code>resolution</code><sup>[EV]</sup> - Resolution of figures
being generated (numeric)</p></li>
<li><p><code>figenv_preamble</code> and <code>tabenv_preamble</code> -
User-defined code evaluated before figures and tables are built (specify
libraries needed, source files containing user defined code,
etc.)</p></li>
<li><p><code>fig_stamp</code><sup>[PH]</sup> - If this is set to a
string it will stamp the contents of that string at the lower left
portion of the figure after writing. This applies only to figures where
the <code>p_res</code> object is either a vanilla <code>ggplot</code>
object, a paginated <code>ggforce</code> object, or the result of
<code>ggarrage</code> from the <code>ggpubr</code> package. Along with
the regular placeholders, this option can also contain the
<code>===FILE===</code> placeholder. This will be replaced with the full
path to the figure file that is generated.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="building-figures-tables">Building <code>figures</code> &amp; <code>tables</code><a class="anchor" aria-label="anchor" href="#building-figures-tables"></a>
</h3>
<p>Figures and tables are defined in terms of R code that will be
evaluated. There are several objects available in the environment that
can be used when creating these report elements. The following objects
will be defined:</p>
<ul>
<li>
<code>fid</code> - current figure ID (figure environment only)</li>
<li>
<code>tid</code> - current table ID (table environment only)</li>
<li>
<code>fit</code> - <code>nlmixr2</code> fit object</li>
<li>
<code>cat_covars</code> - character object containing the
categorical covariates</li>
<li>
<code>cont_covars</code> - character object containing the
continuous covariates</li>
<li>
<code>height</code> - figure height in inches (figure environment
only)</li>
<li>
<code>obnd</code> - onbrand object of the report document</li>
<li>
<code>output_dir</code> - directory where figures are stored</li>
<li>
<code>resolution</code> - resolution of the figure (figure
environment only)</li>
<li>
<code>rptdetails</code> - result of reading in the report yaml
file</li>
<li>
<code>rpttype</code> - either “Word” or “PowerPoint”</li>
<li>
<code>width</code> - figure width in inches (figure environment
only)</li>
<li>
<code>xpdb</code> - the default yaml file contains code in the
preamble to create this object by running xpose_data_nlmixr(fit) (figure
environment only)</li>
</ul>
</div>
<div class="section level3">
<h3 id="figures">
<code>figures</code><a class="anchor" aria-label="anchor" href="#figures"></a>
</h3>
<p>The figures section consists of figure IDs. These IDs are used again
when defining the Word and PowerPoint report contents. Consider this
example:</p>
<pre><code>figures:
  dv_vs_pred:
    orientation:    "portrait"
    caption:        "dv_vs_pred caption"
    caption_format: "text"
    title:          "dv_vs_pred title"
    cmd: |-
      p_res &lt;- dv_vs_pred(xpdb, caption=NULL, title=NULL) +
      xlab("Observed ===CMPD=== Concentrations (===CUNITS===)") +
      ylab("Population Predicted ===CMPD=== Concentrations (===CUNITS===)")</code></pre>
<p>It creates the figure with the ID <code>dv_vs_pred</code>. It has the
following elements:</p>
<ul>
<li>
<code>orientation</code> - Orientation when used in a Word report,
it can be either “portrait” or “landscape”.</li>
<li>
<code>caption</code><sup>[PH]</sup> - Figure caption in Word
reports.</li>
<li>
<code>caption_format</code> - This element is optional and can be
either <code>"text"</code>(default plain text) or <code>"md"</code>
(Markdown).</li>
<li>
<code>title</code><sup>[PH]</sup> - Slide title when the figure is
used in PowerPoint.</li>
<li>
<code>cmd</code><sup>[PH]</sup> - Command to generate the
figure.</li>
</ul>
<p><strong>Note:</strong> When the <code>cmd</code> is evaluated it
needs to create a variable called <code>p_res</code>. This can be either
a <code>ggplot</code> object, a paginated object from
<code>ggforce</code>, the result of <code>ggarrage</code> from the
<code>ggpubr</code> package, or a vector of file names containing image
files created by the code in <code>cmd</code>. If you want to
conditionally skip the reporting of a figure, you can instead set the
value of <code>p_res</code> to <code>NA</code>. This will generate a
message and prevent inclusion of a build error in the final document.
You should also include any libraries you want in the relevant preamble
section to ensure the functions are available to you.</p>
</div>
<div class="section level3">
<h3 id="tables">
<code>tables</code><a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<p>Tables behave similarly to figures. In the tables section you create
a table ID with the following options specified.</p>
<ul>
<li>
<code>orientation</code> - Orientation when used in a Word report,
it can be either “portrait” or “landscape”.</li>
<li>
<code>caption</code><sup>[PH]</sup> - Table caption in Word
reports.</li>
<li>
<code>caption_format</code> - This element is optional and can be
either <code>"text"</code>(default plain text) or <code>"md"</code>
(Markdown).</li>
<li>
<code>title</code><sup>[PH]</sup> - Slide title when the table is
used in PowerPoint.</li>
<li>
<code>cmd</code><sup>[PH]</sup> - Command to generate the
table.</li>
</ul>
<p>This example will create a table of the parameter estimates.</p>
<pre><code>tables:
  pest_table: 
    orientation:    "portrait"  
    caption:        "Parameter Estimates"
    caption_format: "Parameter Estimates"
    title:          "Parameter Estimates"   
    cmd: |- 
      t_res &lt;- gen_pest_table(
      fit        = fit, 
      obnd       = obnd,
      rptdetails = rptdetails)</code></pre>
<p><strong>Note:</strong> When the <code>cmd</code> is evaluated it
needs to create a variable called <code>t_res</code>. This a list which
can contain the following elements:</p>
<ul>
<li>
<code>df</code> - List of data frames containing the tabular
information.</li>
<li>
<code>ft</code> - List of flextables containing the tabular
information</li>
</ul>
<p>If you only supply the data frames list element, they will be
converted into flextables internally. Flextables will span multiple
pages automatically. If you prefer to have a caption on each page you
can split the tables manually into multiple data frames/flextables. The
reporting functionality is written to support table spanning multiple
pages. If you define a separate table for each page you need to add
those as sequential list elements to the <code>df</code> and
<code>ft</code> elements. For example:</p>
<pre><code><span><span class="va">t_res</span><span class="op">$</span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t_res</span><span class="op">$</span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t_res</span><span class="op">$</span><span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">etc</span></span></code></pre>
<p>or</p>
<pre><code><span><span class="va">t_res</span><span class="op">$</span><span class="va">ft</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t_res</span><span class="op">$</span><span class="va">ft</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">t_res</span><span class="op">$</span><span class="va">ft</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">etc</span></span></code></pre>
<p>If you only have a single table or if you want it to span multiple
pages automatically you simply specify the first element listed above
(e.g. <code>t_res$df[[1]]</code>).</p>
<p>If you want to conditionally skip the generation of a table, simply
set <code>t_res</code> to <code>NA</code>. Like with figures above, this
will signal to the reporting functions that you do not want to generate
this table for the current fit object. It will also prevent the
generation of a build error.</p>
</div>
<div class="section level3">
<h3 id="pptx">
<code>pptx</code><a class="anchor" aria-label="anchor" href="#pptx"></a>
</h3>
<p>This section defines general aspects of PowerPoint reports and also
the contents of the report relating to the fitting results. Both the
<code>figures</code> and <code>tables</code> sections contain the
<code>onbrand</code> slide master names (<code>"content_text"</code>) to
be used to hold these objects. The slides will be created with a title
specified in figure and table IDs. The placeholder name for the title
(<code>"title"</code>) must be specified as well as the placeholder name
for the content (<code>"content_body"</code>). Figures for PowerPoint
reports must be generated in the dimensions of the placeholder, so it is
important that the <code>width</code> and <code>height</code> elements
are specified in inches.</p>
<pre><code><span><span class="va">pptx</span><span class="op">:</span></span>
<span>  <span class="va">figures</span><span class="op">:</span></span>
<span>    <span class="va">master</span><span class="op">:</span>   </span>
<span>      <span class="va">name</span><span class="op">:</span>       <span class="st">"content_text"</span>      </span>
<span>      <span class="va">title_ph</span><span class="op">:</span>   <span class="st">"title"</span>   </span>
<span>      <span class="va">content_ph</span><span class="op">:</span> <span class="st">"content_body"</span></span>
<span>    <span class="va">width</span><span class="op">:</span>  <span class="fl">9.5</span></span>
<span>    <span class="va">height</span><span class="op">:</span> <span class="fl">5.0</span></span>
<span>  <span class="va">tables</span><span class="op">:</span>  </span>
<span>    <span class="va">master</span><span class="op">:</span>   </span>
<span>      <span class="va">name</span><span class="op">:</span>       <span class="st">"content_text"</span>      </span>
<span>      <span class="va">title_ph</span><span class="op">:</span>   <span class="st">"title"</span>   </span>
<span>      <span class="va">content_ph</span><span class="op">:</span> <span class="st">"content_body"</span></span></code></pre>
<p>The actual content is specified in the <code>content</code> section.
This is a list of keywords followed by a value. The <code>table</code>
keyword should be followed by a table ID defined in the
<code>tables</code> section. Similarly the <code>figure</code> keyworld
should be followed by a figure ID defined in the <code>figures</code>
section:</p>
<pre><code><span>  <span class="va">content</span><span class="op">:</span>  </span>
<span>    <span class="op">-</span> <span class="va">table</span><span class="op">:</span> <span class="va">pest_table</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">ind_plots</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">dv_vs_pred</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">dv_vs_ipred</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">res_vs_pred</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">res_vs_idv</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">prm_vs_iteration</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">absval_res_vs_pred</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="docx">
<code>docx</code><a class="anchor" aria-label="anchor" href="#docx"></a>
</h3>
<p>This section starts with general information about word documents.
The <code>figures</code> section defines the height and width of figures
for both <code>landscape</code> and <code>portrait</code> orientations.
Again the units here are inches.</p>
<pre><code><span><span class="va">docx</span><span class="op">:</span></span>
<span>  <span class="va">figures</span><span class="op">:</span></span>
<span>    <span class="va">landscape</span><span class="op">:</span></span>
<span>      <span class="va">width</span><span class="op">:</span>  <span class="fl">8.0</span></span>
<span>      <span class="va">height</span><span class="op">:</span> <span class="fl">4.2</span></span>
<span>    <span class="va">portrait</span><span class="op">:</span></span>
<span>      <span class="va">width</span><span class="op">:</span>  <span class="fl">6.5</span></span>
<span>      <span class="va">height</span><span class="op">:</span> <span class="fl">6.0</span></span></code></pre>
<p>Just like with PowerPoint the content is defined in the
<code>content</code> section. This can be defined as a
<code>figure</code> or a <code>table</code> the same as in PowerPoint.
Content can also include text elements as well. Just specify the
<code>onbrand</code> style to control general formatting.</p>
<pre><code><span>  <span class="va">content</span><span class="op">:</span></span>
<span>    <span class="op">-</span> <span class="va">text</span><span class="op">:</span> </span>
<span>        <span class="va">text</span><span class="op">:</span>  <span class="st">"Figures"</span></span>
<span>        <span class="va">style</span><span class="op">:</span> <span class="va">Heading_1</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">dv_vs_pred</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">ind_plots</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">dv_vs_ipred</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">res_vs_pred</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">res_vs_idv</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">prm_vs_iteration</span></span>
<span>    <span class="op">-</span> <span class="va">figure</span><span class="op">:</span> <span class="va">absval_res_vs_pred</span></span>
<span>    <span class="op">-</span> <span class="va">text</span><span class="op">:</span> </span>
<span>        <span class="va">text</span><span class="op">:</span>  <span class="st">"Tables"</span></span>
<span>        <span class="va">style</span><span class="op">:</span> <span class="va">Heading_1</span></span>
<span>    <span class="op">-</span> <span class="va">table</span><span class="op">:</span> <span class="va">pest_table</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="customizing-reports-for-your-organization">Customizing reports for your organization<a class="anchor" aria-label="anchor" href="#customizing-reports-for-your-organization"></a>
</h2>
<p>The reporting here is done using the <code>onbrand</code> package.
This provides an abstraction layer to the <code>officer</code> package.
The benefit here is that you can use your own organization Word and
PowerPoint templates. Simply create them with the appropriate masters
for PowerPoint or styles for Word, then create an on brand mapping file.
When you initialize your report objects you can just provide the your
organizational template and mapping files. For more details on how to
create the templates and mapping files, see the vignette in the
<code>onbrand</code> package.</p>
<div class="section level3">
<h3 id="powerpoint">PowerPoint<a class="anchor" aria-label="anchor" href="#powerpoint"></a>
</h3>
<p>To create an <code>onbrand</code> PowerPoint template for your
organization you will need the following master slide names define with
the corresponding elements.</p>
<template id="03eaaf36-6ce2-4405-9f6d-3558792779a5"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style>
<div class="tabwid">
<style>.cl-92f4fce2{}.cl-92f158f8{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-92f1590c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-92f166ea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-92f18d78{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92f18d79{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92f18d82{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-92f4fce2">
<thead>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d82"><p class="cl-92f166ea"><span class="cl-92f158f8">Master/Template</span></p></td>
<td class="cl-92f18d82"><p class="cl-92f166ea"><span class="cl-92f158f8">onbrand</span></p></td>
<td class="cl-92f18d82"><p class="cl-92f166ea"><span class="cl-92f158f8">Content</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d82"><p class="cl-92f166ea"><span class="cl-92f158f8">Name</span></p></td>
<td class="cl-92f18d82"><p class="cl-92f166ea"><span class="cl-92f158f8">Placeholder</span></p></td>
<td class="cl-92f18d82"><p class="cl-92f166ea"><span class="cl-92f158f8">Type</span></p></td>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-92f18d78"><p class="cl-92f166ea"><span class="cl-92f1590c">title_slide</span></p></td>
<td class="cl-92f18d78"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d78"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">section_slide</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title_only</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_text</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_body</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_list</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_body</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">list</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="6" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">two_content_header_list</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_left_header</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_left</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">list</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_right_header</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_right</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">list</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="6" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">two_content_header_text</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_left_header</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_left</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_right_header</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_right</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="4" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">two_content_list</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_left</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">list</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_right</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">list</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="4" class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">two_content_text</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">sub_title</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_left</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">content_right</span></p></td>
<td class="cl-92f18d79"><p class="cl-92f166ea"><span class="cl-92f1590c">text</span></p></td>
</tr>
</tbody>
</table>
</div></template><div class="flextable-shadow-host" id="67b7f833-2218-41b6-9638-cfea30114e1b"></div>
<script>
var dest = document.getElementById("67b7f833-2218-41b6-9638-cfea30114e1b");
var template = document.getElementById("03eaaf36-6ce2-4405-9f6d-3558792779a5");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>
</div>
<div class="section level3">
<h3 id="word">Word<a class="anchor" aria-label="anchor" href="#word"></a>
</h3>
<p>Similarly, to create an <code>onbrand</code> Word template you will
need to the following <code>onbrand</code> styles defined.</p>
<template id="5337572f-18e7-4a4d-8a0c-d2727b0fb9c6"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style>
<div class="tabwid">
<style>.cl-930cb3dc{}.cl-93099bb6{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-93099bc0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9309a304{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9309b952{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b953{width:95.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b95c{width:70.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b95d{width:95.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b95e{width:70.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b966{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b967{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b968{width:95.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b969{width:70.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b970{width:95.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b971{width:70.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b97a{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b97b{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b97c{width:70.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b984{width:95.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b985{width:95.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b986{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9309b987{width:70.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-930cb3dc">
<thead>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b985"><p class="cl-9309a304"><span class="cl-93099bb6">onbrand</span></p></td>
<td class="cl-9309b986"><p class="cl-9309a304"><span class="cl-93099bb6">Word</span></p></td>
<td class="cl-9309b987"><p class="cl-9309a304"><span class="cl-93099bb6">Style</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b985"><p class="cl-9309a304"><span class="cl-93099bb6">Style</span></p></td>
<td class="cl-9309b986"><p class="cl-9309a304"><span class="cl-93099bb6">Style</span></p></td>
<td class="cl-9309b987"><p class="cl-9309a304"><span class="cl-93099bb6">Type</span></p></td>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b953"><p class="cl-9309a304"><span class="cl-93099bc0">Code</span></p></td>
<td class="cl-9309b952"><p class="cl-9309a304"><span class="cl-93099bc0">Code</span></p></td>
<td class="cl-9309b95c"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b968"><p class="cl-9309a304"><span class="cl-93099bc0">Figure_Caption</span></p></td>
<td class="cl-9309b967"><p class="cl-9309a304"><span class="cl-93099bc0">graphic title</span></p></td>
<td class="cl-9309b969"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b970"><p class="cl-9309a304"><span class="cl-93099bc0">Heading_1</span></p></td>
<td class="cl-9309b97a"><p class="cl-9309a304"><span class="cl-93099bc0">heading 1</span></p></td>
<td class="cl-9309b971"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b970"><p class="cl-9309a304"><span class="cl-93099bc0">Heading_2</span></p></td>
<td class="cl-9309b97a"><p class="cl-9309a304"><span class="cl-93099bc0">heading 2</span></p></td>
<td class="cl-9309b971"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b970"><p class="cl-9309a304"><span class="cl-93099bc0">Heading_3</span></p></td>
<td class="cl-9309b97a"><p class="cl-9309a304"><span class="cl-93099bc0">heading 3</span></p></td>
<td class="cl-9309b971"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b970"><p class="cl-9309a304"><span class="cl-93099bc0">Normal</span></p></td>
<td class="cl-9309b97a"><p class="cl-9309a304"><span class="cl-93099bc0">Normal</span></p></td>
<td class="cl-9309b971"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b970"><p class="cl-9309a304"><span class="cl-93099bc0">Notes</span></p></td>
<td class="cl-9309b97a"><p class="cl-9309a304"><span class="cl-93099bc0">Notes</span></p></td>
<td class="cl-9309b971"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b984"><p class="cl-9309a304"><span class="cl-93099bc0">Table_Caption</span></p></td>
<td class="cl-9309b97b"><p class="cl-9309a304"><span class="cl-93099bc0">table title</span></p></td>
<td class="cl-9309b97c"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b970"><p class="cl-9309a304"><span class="cl-93099bc0">TOC</span></p></td>
<td class="cl-9309b97a"><p class="cl-9309a304"><span class="cl-93099bc0">toc 1</span></p></td>
<td class="cl-9309b971"><p class="cl-9309a304"><span class="cl-93099bc0">paragraph</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9309b95d"><p class="cl-9309a304"><span class="cl-93099bc0">Table</span></p></td>
<td class="cl-9309b966"><p class="cl-9309a304"><span class="cl-93099bc0">Table Grid</span></p></td>
<td class="cl-9309b95e"><p class="cl-9309a304"><span class="cl-93099bc0">table</span></p></td>
</tr>
</tbody>
</table>
</div></template><div class="flextable-shadow-host" id="d913331d-9068-48e8-97c0-08bbb72e2677"></div>
<script>
var dest = document.getElementById("d913331d-9068-48e8-97c0-08bbb72e2677");
var template = document.getElementById("5337572f-18e7-4a4d-8a0c-d2727b0fb9c6");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>
</div>
</div>
<div class="section level2">
<h2 id="report-configuration-file-report_fit-yaml">Report configuration file <code>report_fit.yaml</code><a class="anchor" aria-label="anchor" href="#report-configuration-file-report_fit-yaml"></a>
</h2>
<pre><code>placeholders:
  CMPD: Compound Name
  CUNITS: Conc Units
  TUNITS: Time Units
  RUN: RUNN
  OBJ: sprintf("%3g", fit$objf)
parameters:
  lVp:
    md:  "V~p~"
    txt: "Vp" 
  add_err:
    md:  "Add Err"
    txt: "Add Err"
  prop_err:
    md:  "Prop Err"
    txt: "Prop Err"
covariates:
  cat:  NULL
  cont: NULL
options:
  output_dir:   "file.path(getwd(), '===RUN===')"
  resolution:   300
  fig_stamp:    "source: ===FILE==="
  figenv_preamble: |-
    library("ggplot2")
    library("xpose")
    library("ggforce")
    library("ggPMX")   
    xpdb = xpose.nlmixr2::xpose_data_nlmixr(fit)
  tabenv_preamble: NULL
figures:
  dv_vs_pred_ipred:
    orientation: "portrait"
    caption:     "Observed vs Predicted"
    title:       "Observed vs Predicted"
    cmd: |-
      p_pred &lt;- dv_vs_pred(xpdb, caption=NULL, title=NULL, subtitle=NULL) +
      ggtitle("===CMPD=== (===CUNITS===)") +
      coord_fixed()+
      ylab("Observed") +
      xlab("Population Predicted") +
      theme_light()
      yrange = layer_scales(p_pred)$y$range$range
      xrange = layer_scales(p_pred)$x$range$range
      lb = min(c(yrange,xrange))
      ub = max(c(yrange,xrange))
      p_pred = p_pred + xlim(c(lb, ub)) + ylim(c(lb,ub))

      p_ipred &lt;- dv_vs_ipred(xpdb, caption=NULL, title=NULL, subtitle=NULL) +
      ggtitle("===CMPD=== (===CUNITS===)") +
      coord_fixed()+
      ylab("Observed") +
      xlab("Individual Predicted") +
      theme_light()
      yrange = layer_scales(p_ipred)$y$range$range
      xrange = layer_scales(p_ipred)$x$range$range
      lb = min(c(yrange,xrange))
      ub = max(c(yrange,xrange))
      p_ipred = p_ipred + xlim(c(lb, ub)) + ylim(c(lb,ub))
      p_res &lt;- ggpubr::ggarrange(p_pred, p_ipred, ncol=2, nrow=1 )
  res_vs_pred_idv:
    orientation: "portrait"
    caption:     "CWRES vs Pred and Time"
    title:       "CWRES vs Pred and Time"
    cmd: |-
      if("CWRES" %in% names(fit)){
        p_pred &lt;- res_vs_pred(xpdb, caption=NULL, title=NULL, res="CWRES") +
        ggtitle("===CMPD=== (===CUNITS===)") +
        ylab("CWRES") +
        xlab("Population Predicted") +
        theme_light()
        
        p_idv  &lt;- res_vs_idv(xpdb, caption=NULL, title=NULL, res="CWRES") +
        ggtitle("Time (===CUNITS===)") +
        ylab("CWRES") +
        xlab("Time (===TUNITS===)") +
        theme_light()

        p_res &lt;- ggpubr::ggarrange(p_pred, p_idv, ncol=2, nrow=1 )
      } else {
        p_res &lt;- NA
      }
  eta_cat:
    orientation: "landscape"
    caption:     "Effect of categorical covariates"
    title:       "Effect of categorical covariates"
    cmd: |-
      if(!is.null(cat_covars)){
        ctr = ggPMX::pmx_nlmixr(fit,
                vpc = FALSE,
                conts = cont_covars, 
                cats  = cat_covars)
        p_res &lt;- ggPMX::pmx_plot_eta_cats(ctr) +
          theme_light()
      } else {
        p_res &lt;- NA
      }
  eta_cont:
    orientation: "landscape"
    caption:     "Effect of continuous covariates"
    title:       "Effect of continuous covariates"
    cmd: |-
      if(!is.null(cont_covars)){
        ctr = ggPMX::pmx_nlmixr(fit,
                vpc = FALSE,
                conts = cont_covars, 
                cats  = cat_covars)
        p_res &lt;- ggPMX::pmx_plot_eta_conts(ctr) + 
          theme_light()
      } else {
        p_res &lt;- NA
      }
  prm_vs_iteration:
    orientation: "landscape"
    caption:     "SAEM Stabilization"
    title:       "SAEM Stabilization"
    cmd: |-
      p_res &lt;- prm_vs_iteration(xpdb, caption=NULL, title=NULL) +
        theme_light()
  ind_plots:
    orientation: "landscape"
    caption:     "Individual and population prediction overlay"
    title:       "Individual and population prediction overlay"
    cmd: |-
      p_res &lt;- ind_plots(xpdb, nrow=3, ncol=4, caption=NULL, title=NULL)  +
      ylab(" ===CMPD=== (===CUNITS===)") +
      xlab("Time (===TUNITS===)")  +
      theme_light()
  skip_figure:
    orientation: "landscape"
    caption:     "ind_plots caption"
    title:       "ind_plots title"
    cmd: |-
      p_res &lt;- NA
tables:
  skip_table:
    orientation: "portrait"
    caption:     "Parameter Estimates"
    title:       "Parameter Estimates"
    cmd: |-
      t_res &lt;- NA
  pest_table:
    orientation: "portrait"
    caption:     "Parameter Estimates"
    title:       "Parameter Estimates"
    cmd: |-
      t_res &lt;- gen_pest_table(
      fit        = fit,
      obnd       = obnd,
      rptdetails = rptdetails)
pptx:
  figures:
    master:
      name:       "content_text"
      title_ph:   "title"
      content_ph: "content_body"
    width:  9.5
    height: 5.0
  tables:
    master:
      name:       "content_text"
      title_ph:   "title"
      content_ph: "content_body"
  content:
    - table: pest_table
    - table: skip_table
    - figure: ind_plots
    - figure: dv_vs_pred_ipred
    - figure: res_vs_pred_idv
    - figure: prm_vs_iteration
    - figure: eta_cont
    - figure: eta_cat
    - figure: skip_figure
docx:
  figures:
    landscape:
      width:  8.0
      height: 4.2
    portrait:
      width:  6.5
      height: 6.0
  content:
    - text:
        text:  "Tables"
        style: Heading_1
    - table: pest_table
    - text:
        text:  "Figures"
        style: Heading_1
    - figure: ind_plots
    - figure: dv_vs_pred_ipred
    - figure: res_vs_pred_idv
    - figure: prm_vs_iteration
    - figure: skip_figure
    - figure: eta_cont
    - figure: eta_cat</code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Harrold.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
